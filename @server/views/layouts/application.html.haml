
- cache ['application_layout', @page, @is_search_bot, current_tenant] do 

  !!! RDFa
  %html{:lang => "en-US", :'xml:lang' => "en-US", :xmlns => "http://www.w3.org/1999/xhtml", :'xmlns:og' => "http://ogp.me/ns#", :'xmlns:fb' => "https://www.facebook.com/2008/fbml"}

    %head{ profile: "http://gmpg.org/xfn/1"}

      - if @title
        %title
          = @title      

      - @meta.each do |meta|
        - if meta[:content]
          %meta{ meta }


      %meta{ :content => 'text/html; charset=UTF-8', "http-equiv" => "Content-Type" }

      %meta{ :http_equiv => "X-UA-Compatible", :content => "IE=edge,chrome=1" }

      %meta{ :name => "fragment", :content => "!" }

      %link{ :href => "favicon.ico", :rel => "icon", :type => "image/vnd.microsoft.icon" }

      //ios
      %link{ :rel => "apple-touch-icon", :href => "touch_icon.png"} 

      //android
      %link{ :rel => "icon", :sizes => "196x196", :href => "touch_icon.png"} 

      = stylesheet_link_tag 'stylesheets/application', debug: false

      - if !@is_search_bot
        %link{ :href => "//fast.fonts.net/cssapi/cd97b194-90f2-4567-be7e-3a72011995f3.css",  :rel => 'stylesheet', :type => 'text/css' }

      /[if IE 9]
        = stylesheet_link_tag 'browser/ie9'
      
      /[if lte IE 8]
        = stylesheet_link_tag 'browser/ie'

      :javascript
        //http://stackoverflow.com/questions/7742781/why-javascript-only-works-after-opening-developer-tools-in-ie-once
        if(!window.console) {
          window.console={
            log : function(){},
            assert : function(){},
            warn : function(){},
            error : function(){},
            time : function(){},
            timeEnd : function(){}
          }
        }

      = javascript_include_tag 'javascripts/load_everything', debug: Rails.env.development?


    %body

      #content.content{ customer: current_tenant.identifier, theme: current_tenant.theme }

      - if !@is_search_bot
        - if APP_CONFIG[:analytics][:google] && APP_CONFIG[:analytics][:google] != ''
          :javascript
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', "#{current_tenant.analytics_google}"]);
            _gaq.push(['_setDomainName', ".#{get_root_domain}"]);
            _gaq.push(['_trackPageview']);


        - if current_tenant.analytics_google && current_tenant.analytics_google != ''
          :javascript
            var _gaq_account = _gaq_account || [];
            _gaq_account.push(['_setAccount', "#{current_tenant.analytics_google}"]);
            _gaq_account.push(['_trackPageview']);

        :javascript
          var $buoop = {vs:{i:8,f:15,o:10.6,s:4,n:9}} ;
          $buoop.ol = window.onload; 
          try {if ($buoop.ol) $buoop.ol();}catch (e) {} 
          var e = document.createElement("script"); 
          e.setAttribute("type", "text/javascript"); 
          e.setAttribute("src", "/browser-update.js"); 
          document.body.appendChild(e); 

