#!/bin/bash

# This script enables you to cut out portions of an .mov file, in particular, screen recordings.
#
# You pass the script a source mov file, and any number of start + duration tuples. These are the 
# sections that YOU WANT TO KEEP.
# 
# Here is a sample command line:
#
# > bin/screencast_cut opinion_slate2 '0:00:00 0:00:05' '0:00:10 0:00:05' '0:00:25 0:00:02'
#
# The script will extract these segments, then sew them back together in the order given, outputting
# them to a modified file title of the source file (trimmed-{title}.mov)
#
#


for ((i=2;i<=$#;i++))
do
  START="$(echo ${!i} | cut -d' ' -f1)"
  DURATION="$(echo ${!i} | cut -d' ' -f2)"
  ffmpeg -i lib/screencasts/exports/$1.mov -ss $START -t $DURATION tmp/trim-$i-$1.mov  
done

find $(pwd)/tmp | grep tmp/trim-.-$1.mov | xargs printf "file '%s'\n" > tmp/temp.txt
ffmpeg -f concat -safe 0 -i tmp/temp.txt -c copy lib/screencasts/exports/trimmed-$1.mov
