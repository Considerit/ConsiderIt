/*!
 * Ahoy.js
 * Simple, powerful JavaScript analytics
 * https://github.com/ankane/ahoy.js
 * v0.4.0
 * MIT License
 */ !function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).ahoy=e()}(this,function(){"use strict";var t,e,i,n,r={set:function(t,e,i,n){var r="",o="";if(i){var a=new Date;a.setTime(a.getTime()+6e4*i),r="; expires="+a.toGMTString()}n&&(o="; domain="+n),document.cookie=t+"="+escape(e)+r+o+"; path=/; samesite=lax"},get:function(t){var e,i,n=t+"=",r=document.cookie.split(";");for(e=0;e<r.length;e++){for(i=r[e];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(n))return unescape(i.substring(n.length,i.length))}return null}},o={urlPrefix:"",visitsUrl:"/ahoy/visits",eventsUrl:"/ahoy/events",page:null,platform:"Web",useBeacon:!0,startOnReady:!0,trackVisits:!0,cookies:!0,cookieDomain:null,headers:{},visitParams:{},withCredentials:!1,visitDuration:240,visitorDuration:1051200},a=window.ahoy||window.Ahoy||{};a.configure=function(t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])},a.configure(a);var s=window.jQuery||window.Zepto||window.$,c=!1,u=[],f="undefined"!=typeof JSON&&void 0!==JSON.stringify,l=[];function h(){return o.urlPrefix+o.eventsUrl}function d(t,e,i){r.set(t,e,i,o.cookieDomain||o.domain)}function v(t){return r.get(t)}function g(t){r.set(t,"",-1)}function y(t){v("ahoy_debug")&&window.console.log(t)}function p(){for(var t;t=u.shift();)t();c=!0}function $(t,e,i){document.addEventListener(t,function(t){var n=function t(e,i){var n=e.matches||e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return n?n.apply(e,[i])?e:e.parentElement?t(e.parentElement,i):null:(y("Unable to match"),null)}(t.target,e);n&&i.call(n,t)})}function k(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})}function x(){o.cookies&&f&&d("ahoy_events",JSON.stringify(l),1)}function m(){var t=document.querySelector("meta[name=csrf-token]");return t&&t.content}function w(t){var e=m();e&&t.setRequestHeader("X-CSRF-Token",e)}function b(t,e,i){if(f){if(s&&s.ajax)s.ajax({type:"POST",url:t,data:JSON.stringify(e),contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:w,success:i,headers:o.headers,xhrFields:{withCredentials:o.withCredentials}});else{var n=new XMLHttpRequest;for(var r in n.open("POST",t,!0),n.withCredentials=o.withCredentials,n.setRequestHeader("Content-Type","application/json"),o.headers)o.headers.hasOwnProperty(r)&&n.setRequestHeader(r,o.headers[r]);n.onload=function(){200===n.status&&i()},w(n),n.send(JSON.stringify(e))}}}function S(t){var e={events:[t]};return o.cookies&&(e.visit_token=t.visit_token,e.visitor_token=t.visitor_token),delete t.visit_token,delete t.visitor_token,e}function _(t){a.ready(function(){b(h(),S(t),function(){for(var e=0;e<l.length;e++)if(l[e].id==t.id){l.splice(e,1);break}x()})})}function C(){return o.page||window.location.pathname}function P(t){return t&&t.length>0?t:null}function T(){return function t(e){for(var i in e)e.hasOwnProperty(i)&&null===e[i]&&delete e[i];return e}({tag:this.tagName.toLowerCase(),id:P(this.id),class:P(this.className),page:C(),section:function t(e){for(;e&&e!==document;e=e.parentNode)if(e.hasAttribute("data-section"))return e.getAttribute("data-section");return null}(this)})}function V(){if(c=!1,e=a.getVisitId(),i=a.getVisitorId(),n=v("ahoy_track"),!1===o.cookies||!1===o.trackVisits)y("Visit tracking disabled"),p();else if(e&&i&&!n)y("Active visit"),p();else if(e||d("ahoy_visit",e=k(),o.visitDuration),v("ahoy_visit")){y("Visit started"),i||d("ahoy_visitor",i=k(),o.visitorDuration);var t={visit_token:e,visitor_token:i,platform:o.platform,landing_page:window.location.href,screen_width:window.screen.width,screen_height:window.screen.height,js:!0};for(var r in document.referrer.length>0&&(t.referrer=document.referrer),o.visitParams)o.visitParams.hasOwnProperty(r)&&(t[r]=o.visitParams[r]);y(t),b(o.urlPrefix+o.visitsUrl,t,function(){g("ahoy_track"),p()})}else y("Cookies disabled"),p()}a.ready=function(t){c?t():u.push(t)},a.getVisitId=a.getVisitToken=function(){return v("ahoy_visit")},a.getVisitorId=a.getVisitorToken=function(){return v("ahoy_visitor")},a.reset=function(){return g("ahoy_visit"),g("ahoy_visitor"),g("ahoy_events"),g("ahoy_track"),!0},a.debug=function(t){return!1===t?g("ahoy_debug"):d("ahoy_debug","t",525600),!0},a.track=function(t,e){var i={name:t,properties:e||{},time:new Date().getTime()/1e3,id:k(),js:!0};return a.ready(function(){o.cookies&&!a.getVisitId()&&V(),a.ready(function(){var t,e;(y(i),i.visit_token=a.getVisitId(),i.visitor_token=a.getVisitorId(),(o.useBeacon||o.trackNow)&&0===Object.keys(t=o.headers).length&&f&&void 0!==window.navigator.sendBeacon&&!o.withCredentials)?(e=i,a.ready(function(){var t,i=S(e),n=(t=document.querySelector("meta[name=csrf-param]"))&&t.content,r=m();n&&r&&(i[n]=r),i.events_json=JSON.stringify(i.events),delete i.events,window.navigator.sendBeacon(h(),function t(e){var i=new FormData;for(var n in e)e.hasOwnProperty(n)&&i.append(n,e[n]);return i}(i))})):(l.push(i),x(),setTimeout(function(){_(i)},1e3))})}),!0},a.trackView=function(t){var e={url:window.location.href,title:document.title,page:C()};if(t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);a.track("$view",e)},a.trackClicks=function(t){if(void 0===t)throw Error("Missing selector");$("click",t,function(t){var e=T.call(this,t);e.text="input"==e.tag?this.value:(this.textContent||this.innerText||this.innerHTML).replace(/[\s\r\n]+/g," ").trim(),e.href=this.href,a.track("$click",e)})},a.trackSubmits=function(t){if(void 0===t)throw Error("Missing selector");$("submit",t,function(t){var e=T.call(this,t);a.track("$submit",e)})},a.trackChanges=function(t){if(y("trackChanges is deprecated and will be removed in 0.5.0"),void 0===t)throw Error("Missing selector");$("change",t,function(t){var e=T.call(this,t);a.track("$change",e)})};try{l=JSON.parse(v("ahoy_events")||"[]")}catch(O){}for(var j=0;j<l.length;j++)_(l[j]);return a.start=function(){V(),a.start=function(){}},t=function(){o.startOnReady&&a.start()},"interactive"===document.readyState||"complete"===document.readyState?setTimeout(t,0):document.addEventListener("DOMContentLoaded",t),a});