:javascript
  option_stance_data = #{stance_fractions(@option)};
  option_id = #{@option.id};
  //for IE7 compatability
  protovis_stance_has_been_rendered = false;
  

#initiative.guide
  #option_id.hide
    = @option.id
  #position_id.hide
    - if @position
      = @position.id
      
  

  %ol      

    %li.step.breakdown
      .head
        .operations
          -if @position && @position.published
            .you_slider
              = image_tag "slider.png", :title => "This is where you stand on #{@option.designator}."
              =link_to 'Modify your position', edit_option_position_path(@option, @position)
          -else
            =link_to 'submit your own review', new_option_position_path(@option), :class => "submit_a_position shadow_offset add_corner"

        %table.bars
          %tr
            %td
            %td.viz
              = render :partial => "options/stance_histogram"
            %td
                  
          %tr.vizbase
            %td.first
              .inner
                Support
            %td.middle
              .pedestal
            %td.last
              .inner
                Oppose
      
      .position_marker.shadow_offset

        .showing_all
          .triangle 
            &#x25C0;

          %strong
            Click a bar

          to filter the reviews below

        .showing_filtered.hide
          %a.show_all
            Show all reviews


    %li.statements
      - @option.positions.each do |position|
        = render :partial => "positions/statement/show", :locals => { :position => position }

    %li.ranked_points

      .explore#ranked_points.fl 
        %h3.banner
          All reviews

        %h3.subheader
          Ranked pros and cons that reviewers considered important. 
       
        = render :partial => "points/pro_con_list", :locals => { :dynamic => false, :pro_points => @pro_points, :con_points => @con_points }

      .statement_carousel.fr

        .vertical_carousel.vertical


          .paginate.first
            %h3.subheader
              Click to read a review.
              %button.back.fr  
                &#x25B2;
          .carousel
            %ul
              - @option.positions.each do |position|
                = render :partial => "positions/statement/block", :locals => { :position => position }
                
          
          .paginate.last
            %button.forward.not_ajax.fr
              &#x25BC;
          .clear

        .clear


      .clear
    
    %li.clear
  
 
:javascript
  $j('.initiative_item').each(function(){
    var initiative_id = $j(this).attr('id').substring(16);
    
    if (initiative_id == #{@option.id}){
      $j(this).addClass('active');
      $j(this).children('a').addClass('active');
    }
  });

  $j(document).delegate('.point_in_list a.toggle', 'click', function(){
    $j.post('/home/study/1', {
      position_id: #{@position ? @position.id : "''"},
      option_id: #{@option.id},
      point_id: $j(this).parents('.point_in_list').find('.id:first').text(),
      bval: $j(this).hasClass('more')
    });   
  });

- if @position
  :javascript
    $j('.you_slider').css('left', $j('.pedestal').position().left + (6 - #{@position.stance_bucket}) * 64.3 - 30 + 'px');

  
