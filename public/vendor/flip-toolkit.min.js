!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rematrix")):"function"==typeof define&&define.amd?define(["exports","rematrix"],e):e((t||self).FlipToolkit={},t.Rematrix)}(this,function(t,e){function i(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach(function(i){if("default"!==i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}}),e.default=t,e}var n=/*#__PURE__*/i(e),r=function(t){return"number"==typeof t},a=function(t){return"function"==typeof t},s=function(t){return"[object Object]"===Object.prototype.toString.call(t)},o=function(t){return Array.prototype.slice.apply(t)},l=function(t){var e=t.reduce(function(t,e){return t[e]=(t[e]||0)+1,t},{});return Object.keys(e).filter(function(t){return e[t]>1})};function p(t){return[].slice.call(arguments,1).forEach(function(e){if(e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}),t}var u,c=function(t,e,i){return t+(e-t)*i},d={__proto__:null,isNumber:r,isFunction:a,isObject:s,toArray:o,getDuplicateValsAsStrings:l,assign:p,tweenProp:c},f={noWobble:{stiffness:200,damping:26},gentle:{stiffness:120,damping:14},veryGentle:{stiffness:130,damping:17},wobbly:{stiffness:180,damping:12},stiff:{stiffness:260,damping:26}},h=function(t){return s(t)?t:Object.keys(f).indexOf(t)>-1?f[t]:{}};"undefined"!=typeof window&&(u=window.requestAnimationFrame);var g=u=u||function(t){window.setTimeout(t,1e3/60)},m=Date.now(),v="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()-m};function y(t,e){var i=t.indexOf(e);-1!==i&&t.splice(i,1)}var _=/*#__PURE__*/function(){function t(){}return t.prototype.run=function(){var t=this;g(function(){t.springSystem.loop(v())})},t}(),S=function(){this.position=0,this.velocity=0},E=0,A=.001,b=/*#__PURE__*/function(){function t(t){this._id="s"+E++,this._springSystem=t,this.listeners=[],this._startValue=0,this._currentState=new S,this._displacementFromRestThreshold=.001,this._endValue=0,this._overshootClampingEnabled=!1,this._previousState=new S,this._restSpeedThreshold=.001,this._tempState=new S,this._timeAccumulator=0,this._wasAtRest=!0,this._cachedSpringConfig={}}var e=t.prototype;return e.getId=function(){return this._id},e.destroy=function(){this.listeners=[],this._springSystem.deregisterSpring(this)},e.setSpringConfig=function(t){return this._springConfig=t,this},e.getCurrentValue=function(){return this._currentState.position},e.getDisplacementDistanceForState=function(t){return Math.abs(this._endValue-t.position)},e.setEndValue=function(t){if(t===this._endValue)return this;if(this.prevEndValue=t,this._endValue===t&&this.isAtRest())return this;this._startValue=this.getCurrentValue(),this._endValue=t,this._springSystem.activateSpring(this.getId());for(var e=0,i=this.listeners.length;e<i;e++){var n=this.listeners[e].onSpringEndStateChange;n&&n(this)}return this},e.setVelocity=function(t){return t===this._currentState.velocity||(this._currentState.velocity=t,this._springSystem.activateSpring(this.getId())),this},e.setCurrentValue=function(t){this._startValue=t,this._currentState.position=t;for(var e=0,i=this.listeners.length;e<i;e++){var n=this.listeners[e];n.onSpringUpdate&&n.onSpringUpdate(this)}return this},e.setAtRest=function(){return this._endValue=this._currentState.position,this._tempState.position=this._currentState.position,this._currentState.velocity=0,this},e.setOvershootClampingEnabled=function(t){return this._overshootClampingEnabled=t,this},e.isOvershooting=function(){var t=this._startValue,e=this._endValue;return this._springConfig.tension>0&&(t<e&&this.getCurrentValue()>e||t>e&&this.getCurrentValue()<e)},e.advance=function(t,e){var i=this.isAtRest();if(!i||!this._wasAtRest){var n=e;e>.064&&(n=.064),this._timeAccumulator+=n;for(var r,a,s,o,l,p,u=this._springConfig.tension,c=this._springConfig.friction,d=this._currentState.position,f=this._currentState.velocity,h=this._tempState.position,g=this._tempState.velocity;this._timeAccumulator>=A;)this._timeAccumulator-=A,this._timeAccumulator<A&&(this._previousState.position=d,this._previousState.velocity=f),a=u*(this._endValue-h)-c*f,o=u*(this._endValue-(h=d+(r=f)*A*.5))-c*(g=f+a*A*.5),p=u*(this._endValue-(h=d+(s=g)*A*.5))-c*(g=f+o*A*.5),h=d+(l=g)*A,d+=1/6*(r+2*(s+l)+(g=f+p*A))*A,f+=1/6*(a+2*(o+p)+(u*(this._endValue-h)-c*g))*A;this._tempState.position=h,this._tempState.velocity=g,this._currentState.position=d,this._currentState.velocity=f,this._timeAccumulator>0&&this._interpolate(this._timeAccumulator/A),(this.isAtRest()||this._overshootClampingEnabled&&this.isOvershooting())&&(this._springConfig.tension>0?(this._startValue=this._endValue,this._currentState.position=this._endValue):(this._endValue=this._currentState.position,this._startValue=this._endValue),this.setVelocity(0),i=!0);var m=!1;this._wasAtRest&&(this._wasAtRest=!1,m=!0);var v=!1;i&&(this._wasAtRest=!0,v=!0),this.notifyPositionUpdated(m,v)}},e.notifyPositionUpdated=function(t,e){var i=this;this.listeners.filter(Boolean).forEach(function(n){t&&n.onSpringActivate&&!i._onActivateCalled&&(n.onSpringActivate(i),i._onActivateCalled=!0),n.onSpringUpdate&&n.onSpringUpdate(i),e&&n.onSpringAtRest&&n.onSpringAtRest(i)})},e.systemShouldAdvance=function(){return!this.isAtRest()||!this.wasAtRest()},e.wasAtRest=function(){return this._wasAtRest},e.isAtRest=function(){return Math.abs(this._currentState.velocity)<this._restSpeedThreshold&&(this.getDisplacementDistanceForState(this._currentState)<=this._displacementFromRestThreshold||0===this._springConfig.tension)},e._interpolate=function(t){this._currentState.position=this._currentState.position*t+this._previousState.position*(1-t),this._currentState.velocity=this._currentState.velocity*t+this._previousState.velocity*(1-t)},e.addListener=function(t){return this.listeners.push(t),this},e.addOneTimeListener=function(t){var e=this;return Object.keys(t).forEach(function(i){var n;t[i]=(n=t[i],function(){n.apply(void 0,[].slice.call(arguments)),e.removeListener(t)})}),this.listeners.push(t),this},e.removeListener=function(t){return y(this.listeners,t),this},t}(),C=/*#__PURE__*/function(){function t(t){this.looper=t||new _,this.looper.springSystem=this,this.listeners=[],this._activeSprings=[],this._idleSpringIndices=[],this._isIdle=!0,this._lastTimeMillis=-1,this._springRegistry={}}var e=t.prototype;return e.createSpring=function(t,e){return this.createSpringWithConfig({tension:t,friction:e})},e.createSpringWithConfig=function(t){var e=new b(this);return this.registerSpring(e),e.setSpringConfig(t),e},e.getIsIdle=function(){return this._isIdle},e.registerSpring=function(t){this._springRegistry[t.getId()]=t},e.deregisterSpring=function(t){y(this._activeSprings,t),delete this._springRegistry[t.getId()]},e.advance=function(t,e){for(var i=this;this._idleSpringIndices.length>0;)this._idleSpringIndices.pop();for(this._activeSprings.filter(Boolean).forEach(function(n){n.systemShouldAdvance()?n.advance(t/1e3,e/1e3):i._idleSpringIndices.push(i._activeSprings.indexOf(n))});this._idleSpringIndices.length>0;){var n=this._idleSpringIndices.pop();n>=0&&this._activeSprings.splice(n,1)}},e.loop=function(t){var e;-1===this._lastTimeMillis&&(this._lastTimeMillis=t-1);var i=t-this._lastTimeMillis;this._lastTimeMillis=t;var n=0,r=this.listeners.length;for(n=0;n<r;n++)(e=this.listeners[n]).onBeforeIntegrate&&e.onBeforeIntegrate(this);for(this.advance(t,i),0===this._activeSprings.length&&(this._isIdle=!0,this._lastTimeMillis=-1),n=0;n<r;n++)(e=this.listeners[n]).onAfterIntegrate&&e.onAfterIntegrate(this);this._isIdle||this.looper.run()},e.activateSpring=function(t){var e=this._springRegistry[t];-1===this._activeSprings.indexOf(e)&&this._activeSprings.push(e),this.getIsIdle()&&(this._isIdle=!1,this.looper.run())},t}(),I=new C,O=function(t){var e=t.springConfig,i=e.overshootClamping,n=t.getOnUpdateFunc,r=t.onAnimationEnd,a=t.onSpringActivate,s=I.createSpring(e.stiffness,e.damping);s.setOvershootClampingEnabled(!!i);var o={onSpringActivate:a,onSpringAtRest:function(){s.destroy(),r()},onSpringUpdate:n({spring:s,onAnimationEnd:r})};return s.addListener(o),s},w=function(t){var e=O(t);return e.setEndValue(1),e},x=function(t,e){if(void 0===e&&(e={}),t&&t.length){e.reverse&&t.reverse();var i,n="number"!=typeof(i=e.speed)?1.1:1+Math.min(Math.max(5*i,0),5),r=1/Math.max(Math.min(t.length,100),10),a=t.map(function(t,e){var i=t.getOnUpdateFunc;return t.getOnUpdateFunc=function(t){var s=i(t);return function(t){var i=t.getCurrentValue();(i=i<.01?0:i>.99?1:i)>=r&&a[e+1]&&a[e+1](Math.max(Math.min(i*n,1),0)),s(t)}},t}).map(function(t){var e=O(t);if(e)return e.setEndValue.bind(e)}).filter(Boolean);a[0]&&a[0](1)}},U=function(t){return[0,1,4,5,12,13].map(function(e){return t[e]})},F=function(t){return t.top<window.innerHeight&&t.bottom>0&&t.left<window.innerWidth&&t.right>0};function V(t){return JSON.parse(t.dataset.flipConfig||"{}")}var P=function(t,e){var i;return p(t,((i={})[e[0]]=e[1],i))},T=function(t,e){return o(e?document.querySelectorAll('[data-portal-key="'+e+'"]'):t.querySelectorAll("[data-flip-id]"))},R=function(t){return t.map(function(t){return[t,t.getBoundingClientRect()]})},D=function(t){var e=t.cachedOrderedFlipIds,i=void 0===e?[]:e,s=t.inProgressAnimations,u=void 0===s?{}:s,d=t.flippedElementPositionsBeforeUpdate,g=void 0===d?{}:d,m=t.flipCallbacks,v=void 0===m?{}:m,y=t.containerEl,_=t.applyTransformOrigin,S=t.spring,E=t.debug,A=t.portalKey,b=t.staggerConfig,C=void 0===b?{}:b,I=t.decisionData,O=void 0===I?{}:I,D=t.handleEnterUpdateDelete,M=t.onComplete,k=t.onStart,j=function(t){var e=t.flipCallbacks,i=T(t.element,t.portalKey),n=[];return i.map(function(t){var i,r;(e&&(null==e||!e[t.dataset.flipId])||void 0===(null==e?void 0:e[t.dataset.flipId].shouldFlipIgnore)||null==e||null==(i=(r=e[t.dataset.flipId]).shouldFlipIgnore)||!i.call(r))&&n.push(t)}),R(n).map(function(t){var e=t[0],i=t[1],n=window.getComputedStyle(e);return[e.dataset.flipId,{element:e,rect:i,opacity:parseFloat(n.opacity),transform:n.transform}]}).reduce(P,{})}({element:y,portalKey:A,flipCallbacks:v}),B=function(t){var e=t.containerEl,i=t.portalKey;return i?function(t){return function(e){return o(document.querySelectorAll('[data-portal-key="'+t+'"]'+e))}}(i):e?function(t){var e=Math.random().toFixed(5);return t.dataset.flipperId=e,function(i){return o(t.querySelectorAll('[data-flipper-id="'+e+'"] '+i))}}(e):function(){return[]}}({containerEl:y,portalKey:A}),N=function(t){return function(e){return t('[data-flip-id="'+e+'"]')[0]}}(B),L=function(t){return g[t]&&j[t]},q=Object.keys(g).concat(Object.keys(j)).filter(function(t){return!L(t)}),X={flipCallbacks:v,getElement:N,flippedElementPositionsBeforeUpdate:g,flippedElementPositionsAfterUpdate:j,inProgressAnimations:u,decisionData:O},Y=function(t){var e,i=t.unflippedIds,n=t.flipCallbacks,r=t.getElement,a=t.flippedElementPositionsBeforeUpdate,s=t.flippedElementPositionsAfterUpdate,o=t.inProgressAnimations,l=t.decisionData,p=i.filter(function(t){return s[t]}).filter(function(t){return n[t]&&n[t].onAppear}),u=i.filter(function(t){return a[t]&&n[t]&&n[t].onExit}),c=new Promise(function(t){e=t}),d=[],f=0,h=u.map(function(t,i){var r=a[t].domDataForExitAnimations,s=r.element,p=r.parent,u=r.childPosition,c=u.top,h=u.left,g=u.width,m=u.height;"static"===getComputedStyle(p).position&&(p.style.position="relative"),s.style.transform="matrix(1, 0, 0, 1, 0, 0)",s.style.position="absolute",s.style.top=c+"px",s.style.left=h+"px",s.style.height=m+"px",s.style.width=g+"px";var v=d.filter(function(t){return t[0]===p})[0];v||(v=[p,document.createDocumentFragment()],d.push(v)),v[1].appendChild(s),f+=1;var y=function(){try{p.removeChild(s)}catch(t){}finally{0==(f-=1)&&e()}};return o[t]={stop:y},function(){return n[t].onExit(s,i,y,l)}});return d.forEach(function(t){t[0].appendChild(t[1])}),h.length||e(),{hideEnteringElements:function(){p.forEach(function(t){var e=r(t);e&&(e.style.opacity="0")})},animateEnteringElements:function(){p.forEach(function(t,e){var i=r(t);i&&n[t].onAppear(i,e,l)})},animateExitingElements:function(){return h.forEach(function(t){return t()}),c}}}(p({},X,{unflippedIds:q})),K=Y.hideEnteringElements,W=Y.animateEnteringElements,H=Y.animateExitingElements,J=p({},X,{containerEl:y,flippedIds:i.filter(L),applyTransformOrigin:_,spring:S,debug:E,staggerConfig:C,scopedSelector:B,onComplete:M});k&&k(y,O);var z=function(t){var e,i=t.flippedIds,s=t.flipCallbacks,u=t.inProgressAnimations,d=t.flippedElementPositionsBeforeUpdate,g=t.flippedElementPositionsAfterUpdate,m=t.applyTransformOrigin,v=t.spring,y=t.getElement,_=t.debug,S=t.staggerConfig,E=void 0===S?{}:S,A=t.decisionData,b=void 0===A?{}:A,C=t.onComplete,I=t.containerEl,O=new Promise(function(t){e=t});if(C&&O.then(function(){return C(I,b)}),!i.length)return function(){return e([]),O};var P=[],T=y(i[0]),R=T?T.ownerDocument.querySelector("body"):document.querySelector("body");l(i);var D=i.map(function(t){var i=d[t].rect,l=g[t].rect,y=d[t].opacity,_=g[t].opacity,S=l.width<1||l.height<1,E=g[t].element;if(!F(i)&&!F(l))return!1;if(!E)return!1;var A,C,I,O=V(E),w=(I=(C=void 0===(A={flipperSpring:v,flippedSpring:O.spring})?{}:A).flippedSpring,p({},f.noWobble,h(C.flipperSpring),h(I))),x=!0===O.stagger?"default":O.stagger,T={element:E,id:t,stagger:x,springConfig:w};if(s[t]&&s[t].shouldFlip&&!s[t].shouldFlip(b.previous,b.current))return!1;var M=Math.abs(i.left-l.left)+Math.abs(i.top-l.top),k=Math.abs(i.width-l.width)+Math.abs(i.height-l.height),j=Math.abs(_-y);if(0===i.height&&0===l.height||0===i.width&&0===l.width||M<.5&&k<.5&&j<.01)return!1;var B=n.parse(g[t].transform),N={matrix:B},L={matrix:[]},q=[B];O.translate&&(q.push(n.translateX(i.left-l.left)),q.push(n.translateY(i.top-l.top))),O.scale&&(q.push(n.scaleX(Math.max(i.width,1)/Math.max(l.width,1))),q.push(n.scaleY(Math.max(i.height,1)/Math.max(l.height,1)))),O.opacity&&(L.opacity=y,N.opacity=_);var X=[];if(!s[t]||!s[t].shouldInvert||s[t].shouldInvert(b.previous,b.current)){var Y=function(t,e){return o(t.querySelectorAll('[data-inverse-flip-id="'+e+'"]'))}(E,t);X=Y.map(function(t){return[t,V(t)]})}L.matrix=U(q.reduce(n.multiply)),N.matrix=U(N.matrix);var K,W=function(t){var e=t.element,i=t.invertedChildren,n=t.body;return function(t){var a=t.matrix,s=t.opacity,o=t.forceMinVals;if(r(s)&&(e.style.opacity=s+""),o&&(e.style.minHeight="1px",e.style.minWidth="1px"),a){var l=function(t){return"matrix("+t.join(", ")+")"}(a);e.style.transform=l,i&&function(t){var e=t.matrix,i=t.body;t.invertedChildren.forEach(function(t){var n=t[0],r=t[1];if(i.contains(n)){var a=e[0],s=e[3],o=e[5],l={translateX:0,translateY:0,scaleX:1,scaleY:1},p="";r.translate&&(l.translateX=-e[4]/a,l.translateY=-o/s,p+="translate("+l.translateX+"px, "+l.translateY+"px)"),r.scale&&(l.scaleX=1/a,l.scaleY=1/s,p+=" scale("+l.scaleX+", "+l.scaleY+")"),n.style.transform=p}})}({invertedChildren:i,matrix:a,body:n})}}}({element:E,invertedChildren:X,body:R});if(s[t]&&s[t].onComplete){var H=s[t].onComplete;K=function(t){return H(E,b,t)}}var J=r(L.opacity)&&r(N.opacity)&&L.opacity!==N.opacity,z=!1;return p({},T,{stagger:x,springConfig:w,getOnUpdateFunc:function(e){var i=e.spring,n=e.onAnimationEnd;return u[t]={destroy:i.destroy.bind(i),onAnimationEnd:n},function(e){s[t]&&s[t].onSpringUpdate&&s[t].onSpringUpdate(e.getCurrentValue()),z||(z=!0,s[t]&&s[t].onStart&&s[t].onStart(E,b));var i=e.getCurrentValue();if(R.contains(E)){var n={matrix:[]};n.matrix=L.matrix.map(function(t,e){return c(t,N.matrix[e],i)}),J&&(n.opacity=c(L.opacity,N.opacity,i)),W(n)}else e.destroy()}},initializeFlip:function(){W({matrix:L.matrix,opacity:J?L.opacity:void 0,forceMinVals:S}),s[t]&&s[t].onStartImmediate&&s[t].onStartImmediate(E,b),O.transformOrigin?E.style.transformOrigin=O.transformOrigin:m&&(E.style.transformOrigin="0 0"),X.forEach(function(t){var e=t[0],i=t[1];i.transformOrigin?e.style.transformOrigin=i.transformOrigin:m&&(e.style.transformOrigin="0 0")})},onAnimationEnd:function(i){delete u[t],a(K)&&K(!!i),E.style.transform="",X.forEach(function(t){t[0].style.transform=""}),S&&E&&(E.style.minHeight="",E.style.minWidth=""),i||(P.push(t),P.length>=D.length&&e(P))},delayUntil:O.delayUntil})}).filter(Boolean);if(D.forEach(function(t){return(0,t.initializeFlip)()}),_)return function(){};var M=D.filter(function(t){return t.delayUntil&&(e=t.delayUntil,D.filter(function(t){return t.id===e}).length);var e}),k={},j={},B={};M.forEach(function(t){t.stagger?(B[t.stagger]=!0,j[t.delayUntil]?j[t.delayUntil].push(t.stagger):j[t.delayUntil]=[t.stagger]):k[t.delayUntil]?k[t.delayUntil].push(t):k[t.delayUntil]=[t]});var N=D.filter(function(t){return t.stagger}).reduce(function(t,e){return t[e.stagger]?t[e.stagger].push(e):t[e.stagger]=[e],t},{}),L=D.filter(function(t){return-1===M.indexOf(t)});return L.forEach(function(t){t.onSpringActivate=function(){k[t.id]&&k[t.id].forEach(w),j[t.id]&&Object.keys(j[t.id].reduce(function(t,e){var i;return p(t,((i={})[e]=!0,i))},{})).forEach(function(t){x(N[t],E[t])})}}),function(){return D.length||e([]),L.filter(function(t){return!t.stagger}).forEach(w),Object.keys(N).forEach(function(t){B[t]||x(N[t],E[t])}),O}}(J);D?D({hideEnteringElements:K,animateEnteringElements:W,animateExitingElements:H,animateFlippedElements:z}):(K(),H().then(W),z())},M=function(t){var e=t.element,i=t.flipCallbacks,n=void 0===i?{}:i,r=t.inProgressAnimations,a=void 0===r?{}:r,s=T(e,t.portalKey),l=[];s.map(function(t){var e,i;(n&&!n[t.dataset.flipId]||void 0===(null==n?void 0:n[t.dataset.flipId].shouldFlipIgnore)||null==n||null==(e=(i=n[t.dataset.flipId]).shouldFlipIgnore)||!e.call(i))&&l.push(t)});var u=o(e.querySelectorAll("[data-inverse-flip-id]")),c={},d=[],f={};l.filter(function(t){return n&&n[t.dataset.flipId]&&n[t.dataset.flipId].onExit}).forEach(function(t){var e=t.parentNode;if(t.closest){var i=t.closest("[data-exit-container]");i&&(e=i)}var n=d.findIndex(function(t){return t[0]===e});-1===n&&(d.push([e,e.getBoundingClientRect()]),n=d.length-1),c[t.dataset.flipId]=d[n][1],f[t.dataset.flipId]=e});var h=R(l),g=h.map(function(t){var e=t[0],i=t[1],r={};if(n&&n[e.dataset.flipId]&&n[e.dataset.flipId].onExit){var a=c[e.dataset.flipId];p(r,{element:e,parent:f[e.dataset.flipId],childPosition:{top:i.top-a.top,left:i.left-a.left,width:i.width,height:i.height}})}return[e.dataset.flipId,{rect:i,opacity:parseFloat(window.getComputedStyle(e).opacity||"1"),domDataForExitAnimations:r}]}).reduce(P,{});return function(t,e){Object.keys(t).forEach(function(e){t[e].destroy&&t[e].destroy(),t[e].onAnimationEnd&&t[e].onAnimationEnd(!0),delete t[e]}),e.forEach(function(t){t.style.transform="",t.style.opacity=""})}(a,l.concat(u)),{flippedElementPositions:g,cachedOrderedFlipIds:h.map(function(t){return t[0].dataset.flipId})}},k=/*#__PURE__*/function(){function t(t){this.applyTransformOrigin=!0,p(this,t),this.inProgressAnimations={},this.flipCallbacks={},this.recordBeforeUpdate=this.recordBeforeUpdate.bind(this),this.update=this.update.bind(this),this.addFlipped=this.addFlipped.bind(this),this.addInverted=this.addInverted.bind(this)}var e=t.prototype;return e.recordBeforeUpdate=function(){this.snapshot=M({element:this.element,flipCallbacks:this.flipCallbacks,inProgressAnimations:this.inProgressAnimations})},e.update=function(t,e){this.snapshot&&(D({flippedElementPositionsBeforeUpdate:this.snapshot.flippedElementPositions,cachedOrderedFlipIds:this.snapshot.cachedOrderedFlipIds,containerEl:this.element,inProgressAnimations:this.inProgressAnimations,flipCallbacks:this.flipCallbacks,applyTransformOrigin:this.applyTransformOrigin,spring:this.spring,debug:this.debug,staggerConfig:this.staggerConfig,handleEnterUpdateDelete:this.handleEnterUpdateDelete,decisionData:{previous:t,current:e},onComplete:this.onComplete,onStart:this.onStart}),delete this.snapshot)},e.addFlipped=function(t){var e=t.element,i=t.flipId,n=t.opacity,r=t.translate,a=t.scale,s=t.transformOrigin,o=t.spring,l=t.stagger,u=t.delayUntil,c=t.onAppear,d=t.onStart,f=t.onSpringUpdate,h=t.onComplete,g=t.onExit,m=t.shouldFlip,v=t.shouldInvert;if(!e)throw new Error("no element provided");if(!i)throw new Error("No flipId provided");var y={scale:a,translate:r,opacity:n,transformOrigin:s,spring:o,stagger:l,delayUntil:u};y.scale||y.translate||y.opacity||p(y,{translate:!0,scale:!0,opacity:!0}),i&&(e.dataset.flipId=String(i)),e.dataset.flipConfig=JSON.stringify(y),this.flipCallbacks[i]={shouldFlip:m,shouldInvert:v,onAppear:c,onStart:d,onSpringUpdate:f,onComplete:h,onExit:g}},e.addInverted=function(t){var e=t.element,i=t.parent,n=t.opacity,r=t.translate,a=t.scale,s=t.transformOrigin;if(!e)throw new Error("no element provided");if(!i)throw new Error("parent must be provided");var o=i.dataset.flipId,l={scale:a,translate:r,opacity:n,transformOrigin:s};l.scale||l.translate||l.opacity||p(l,{translate:!0,scale:!0,opacity:!0}),e.dataset.inverseFlipId=o,e.dataset.flipConfig=JSON.stringify(l)},t}(),j=new C;t.Flipper=k,t.constants={__proto__:null,DATA_FLIP_ID:"data-flip-id",DATA_INVERSE_FLIP_ID:"data-inverse-flip-id",DATA_FLIP_COMPONENT_ID:"data-flip-component-id",DATA_FLIP_CONFIG:"data-flip-config",DATA_PORTAL_KEY:"data-portal-key",DATA_EXIT_CONTAINER:"data-exit-container"},t.getFlippedElementPositionsBeforeUpdate=M,t.onFlipKeyUpdate=D,t.spring=function(t){var e=t.values,i=t.onUpdate,n=t.delay,r=void 0===n?0:n,a=t.onComplete,s=p({},f.noWobble,h(t.config)),o=s.overshootClamping,l=j.createSpring(s.stiffness,s.damping);return l.setOvershootClampingEnabled(!!o),l.addListener({onSpringAtRest:function(t){a&&a(),t.destroy()},onSpringUpdate:function(t){var n=t.getCurrentValue();if(!e)return i(n);var r=Object.keys(e).map(function(t){return[t,c(e[t][0],e[t][1],n)]}).reduce(function(t,e){var i;return Object.assign(t,((i={})[e[0]]=e[1],i))},{});i(r)}}),r?setTimeout(function(){l.setEndValue(1)},r):l.setEndValue(1),l},t.utilities=d});
//# sourceMappingURL=index.umd.js.map
