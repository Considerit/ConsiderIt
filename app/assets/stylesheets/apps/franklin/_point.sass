$m-point-expanded-width: $body_width + 150

.m-point
  position: relative
  @extend %nude_list

  .m-point-wrap
    position: relative
    display: inline-block

  &.m-point-peer, &.m-point-expanded
    .m-point-wrap
      padding: $vertical_baseline / 2 $grid_xs / 2 $vertical_baseline $grid_xs / 2 
      margin-bottom: $vertical_baseline / 2


  &.m-point-position

  &.m-point-unexpanded
    cursor: pointer

  &.m-point-expanded
    position: relative
    z-index: 999
    // padding: $vertical_baseline $grid_xs  
    width: $m-point-expanded-width + $peer-point-avatar-area


    .m-point-wrap
      width: $m-point-expanded-width - 3


    &.m-point-position
      &.con
        left: $pro-con-list-column-width - $m-point-expanded-width + ($m-point-expanded-width - $body_width) / 2
      &.pro
        left: - ($m-point-expanded-width - $body_width) / 2

.m-peer-reasons

  &[data-state="points-together"]
    .m-point-expanded.con.m-point-peer
      right: $m-point-expanded-width - $peer-point-results-width

  &[data-state="points-separated"]
    .m-point-expanded.con.m-point-peer
      right: $m-point-expanded-width - $peer-point-width


  &[data-state="points-collapsed"]

    .m-point
      z-index: 5
      // .m-point-header-region
      //   display: none

.m-position-points
  // &[data-state="points-hidden"]
  //   display: none




/////////////////////////
// Point text

.m-point-unexpanded
  &.m-point-peer
    .m-point-nutshell
      +font-size(-1)

  &.m-point-position  
    .m-point-nutshell
      +font-size(-1)

  .m-point-details-description 
    display: none


.m-point-expanded
  .m-point-nutshell, .m-point-details-description
    padding-bottom: $vertical_baseline / 2

  .m-point-nutshell
    +font-size(3)
    font-weight: bold

  .m-point-details-description 
    +font-size(0)

//////



//////////////////
// bullet points
.m-point-unexpanded.m-point-position
  padding: 0 $grid_xs 4px $grid_xs

  .m-point-nutshell-wrap
    &:before
      content: $hex-bullet-point
      position: absolute
      top: 0px
      +font-size(-3)

  &.pro .m-point-nutshell-wrap:before
    left: -13px

  &.con .m-point-nutshell-wrap:before
    left: -10px

/////////////

.m-point-unexpanded.m-point-position
  .m-point-author-avatar
    display: none

.m-point-expanded 
  .m-point-follow-region
    margin-bottom: $vertical_baseline / 2


/////////////////////////////////////////
// point operations
.m-point-expanded, [data-state="points-collapsed"]
  .m-point-operations
    display: none

[data-state="points-together"], [data-state="points-separated"]
  .m-point-peer
    .m-point-operations
      visibility: hidden

    &:hover
      .m-point-operations
        visibility: visible

.m-point-unexpanded
  &.m-point-peer
    .m-point-operations        
      position: relative

      .m-point-read-more
        +font-size(-3)


    &.pro
      .m-point-operations
        text-align: left

    &.con
      .m-point-operations
        text-align: right

  &.m-point-position
    &:hover .m-point-operations
      visibility: visible

    .m-point-operations
      visibility: hidden
      padding: $vertical_baseline/8 $grid_xs

      .m-point-read-more
        +font-size(-3)
        margin: 0
        padding: 1px 8px

    .m-point-remove
      margin-top: $grid_xs/4
      padding: 0 $grid_xs/2        

  &.m-point-peer
    &:hover
      .m-point-operations a
        color: #666

    .m-point-operations
      bottom: -3*$vertical_baseline/4

      a
        color: lighten($base_text_color, 15%)

        &:hover
          color: $base_text_color


%point_operation
  @extend %desaturatedbutton
  +font-size(-3)
  &:hover
    +font-size(-3)

.m-point-include, .m-point-assessment-request-initiate, .m-point-remove, .m-point-follow
  @extend %point_operation


///////////////////////////////////////

/////////////////////////////////////////
// point inclusion button
.m-point-peer
  .m-point-include-wrap
    display: none

[data-state="points-separated"] .m-point-peer
  .m-point-include-wrap
    display: block

    .m-point-include
      position: relative
      z-index: 2
      border-radius: 0
  &.con
    .m-point-include
      +scaleX(-1)

  &.m-point-unexpanded

    .m-point-include-wrap
      position: absolute
      bottom: 0//$vertical_baseline / 2

    &.pro
      .m-point-include-wrap
        right: 0
    &.con
      .m-point-include-wrap
        left: 0

    .m-point-include-wrap

      .m-point-include
        border-bottom-right-radius: 8px

    // &.con
    //   .m-point-include-wrap
    //     left: 0
        
    //     .m-point-include
    //       border-bottom-left-radius: 8px

  &.m-point-expanded

    // &.con
    //   .m-point-include-wrap
    //     float: left
    //     left: -$grid_xs - 1
    //     .m-point-include
    //       border-bottom-left-radius: 0px
    //       border-left-color: transparent    

    &.pro
      .m-point-include-wrap
        float: right

    &.con
      .m-point-include-wrap
        float: left

    .m-point-include-wrap
      float: right
      right: -$grid_xs - 1
      .m-point-include
        border-bottom-right-radius: 0px
        border-right-color: transparent    


/////////////////

//////////////////////
// Thought Bubbles...
//////////////////////

= circle($width)
  border-radius: 50%
  width: $width
  height: $width

// %m-thought-bubble

//   // &:before, &:after
//   //   //content: ''
//   //   position: absolute
//   //   border: 1px solid
//   //   border-top-color: transparent
//   //   +transition(left .5s linear, right .5s linear)
//   //   +single-box-shadow($color: rgba(black, .2), $voff: 2px)

//   .m-point-author-avatar
//     display: inline-block
//     border-radius: 8px
//     //top: 2 * $vertical_baseline
//     //border: 1px solid transparent
//     //+single-box-shadow    

//   .m-point-author-avatar
//     width: $peer-point-avatar-area - 3
//     height: $peer-point-avatar-area - 3

//   // &.pro .m-point-author-avatar
//   //   left: -42px

//   // &.con .m-point-author-avatar
//   //   right: -42px



%m-thought-bubble-side-down

  &:before
    +circle(5px)

  &:after
    +circle(7px)


  &:before
    top: 23px

  &:after
    top: 15px

  &.pro
    &:after
      left: -7px
      border-right-color: transparent

    &:before
      left: -13px

  &.con
    &:after
      right: -7px
      border-left-color: transparent

    &:before
      right: -13px

%m-thought-bubble-bottom-in

  &:before
    +circle(6px)

  &:after
    +circle(9px)

  &:before
    bottom: -16px

  &:after
    bottom: -8px
    border-top-color: transparent

  &.pro
    &:after
      left: 60%

    &:before
      left: 63%

  &.con
    &:after
      right: 60%

    &:before
      right: 63%

  //////////////////////

%m-white-thought-bubble
  @extend %m-thought-bubble
  border-radius: 5px
  &:before, &:after
    border-color: #ccc
    background-color: whitesmoke
    //@extend %on_paper

%m-white-thought-bubble-inner
  +single-box-shadow($color: rgba(black, .1), $voff: 1px)
  border-radius: 8px
  border: 1px solid //$dark_community_color
  border-color: #f1f1f1 #ddd #bbb #ddd
  @extend %whitesmoke


// .m-point-expanded
//   @extend %m-white-thought-bubble
//   @extend %m-white-thought-bubble-inner
//   @extend %m-thought-bubble-side-down


[data-state="points-separated"] .m-point-peer.m-point-unexpanded, .m-point-expanded
  // //@extend %m-white-thought-bubble
  // @extend %m-thought-bubble
  .m-point-wrap
    @extend %m-white-thought-bubble-inner

// [data-state="points-collapsed"] .m-point-peer
//   @extend %m-thought-bubble-bottom-in

[data-state="points-separated"] .m-point-peer.m-point-unexpanded
  //@extend %m-thought-bubble-side-down

.m-point-position.m-point-unexpanded .m-point-wrap
  background-color: $decision_board_color

.m-point-author-avatar
  display: inline-block
  position: relative
  border-radius: 8px
  top: .7 * $vertical_baseline
  width: 35px
  height: 35px  
  //border: 1px solid transparent
  //+single-box-shadow    

//[data-state="points-together"], [data-state="points-collapsed"]

.m-point-peer.m-point //.m-point-unexpanded 

  .m-point-wrap
    //margin-bottom: 0
    &:hover 
      +single-box-shadow($color: rgba(black, .2), $voff: 2px)



  // .m-point-author-avatar


  // &.pro .m-point-author-avatar
  //   left: -$peer-point-avatar-area

  // &.con .m-point-author-avatar
  //   right: -$peer-point-avatar-area



.m-point-unexpanded.m-point-peer
  &:hover
    .m-point-wrap //, &:after, &:before
      background-color: white
    &:before, &:after
      background-color: white



///////////
// Discussion
.m-point-discussion
  position: relative

.m-point-discussion-heading
  +font-size(3)
  margin: $vertical_baseline 0

.m-point-comments
  @extend %nude_list
////



