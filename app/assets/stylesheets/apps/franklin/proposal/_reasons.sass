//////////////////
// global layout for reasons & points, in different states

.m-reasons

  // transitions and styles
  .m-point
    +transition(width $transition_speed $transition_function, top $transition_speed linear)
    .m-point-wrap
      +transition(all $transition_speed $transition_function)
      //+transition(width $transition_speed $transition_function, background-color $transition_speed $transition_function, border-color $transition_speed $transition_function, top .5s ease, left .5s ease, color .5s linear, font-size .5s linear, padding-right .1s linear, padding-left .1s linear, padding-top .1s linear, padding-bottom .1s linear)
  .m-reasons-lists
    +transition(width $transition_speed $transition_function, top $transition_speed $transition_function, left $transition_speed $transition_function, right $transition_speed $transition_function)
    //+transition(all $transition_speed $transition_function)

  .m-points-list-region, .m-position-region
    //+transition(width $transition_speed $transition_function, left $transition_speed $transition_function)
    +transition(all $transition_speed $transition_function)

  .m-aggregated-propoints-region, .m-aggregated-conpoints-region
    +transition(width $transition_speed $transition_function, left $transition_speed $transition_function, right $transition_speed $transition_function)

  &[data-state="separated"][data-state-from="together"]
    .m-reasons-lists
      top: -200px // put on top of histogram

  &[data-state="separated"]
    .m-aggregated-propoints-region, .m-aggregated-conpoints-region
      .m-peer-reasons
        border-color: transparent
        background: $bg_declaration
        background-color: whitesmoke

  &[data-state="together"], &[data-state="collapsed"]

    .m-aggregated-propoints-region .m-peer-reasons
      border-radius: 16px 0 0 16px
      border-right-color: transparent

    .m-aggregated-conpoints-region .m-peer-reasons
      border-radius: 0 16px 16px 0
      border-left-color: transparent

  // basic layout

  .m-points-list-region, .m-position-region
    display: inline-block

  .m-position-region
    overflow: hidden

  .m-reasons-lists
    //height: 100%
    top: 0 

  .m-aggregated-propoints-region, .m-aggregated-conpoints-region, .m-position-region

  .m-aggregated-propoints-region, .m-aggregated-conpoints-region
    height: 100%
    .m-peer-reasons
      height: 100%

  .m-aggregated-propoints-region

    .m-point-header-region
      //float: left

  .m-aggregated-conpoints-region

    .m-point-header-region
      float: right

  .m-reasons-lists
    position: absolute  


  //horizontal size and positioning
  $full_reasons_width: $decision_board_width + 2 * $peer-point-results-width + 6 //6 is for borders //+ 2 * $grid_xs
  $full_reasons_left: -($full_reasons_width - $content_width) / 2
  .m-reasons-lists
    padding: 0
    width: $full_reasons_width
    left: $full_reasons_left   //-$peer-point-results-width + $margin_width - 2 * $peer-point-avatar-area //- $grid_xs / 4


  &[data-state="separated"]

    .m-aggregated-propoints-region, .m-aggregated-conpoints-region
      width: $peer-point-width

    .m-point-peer.m-point-unexpanded
      .m-point-wrap
        width: $peer-point-wrap-width

  &[data-state="together"], &[data-state="collapsed"]
    .m-aggregated-propoints-region, .m-aggregated-conpoints-region
      width: $peer-point-results-width

    .m-aggregated-propoints-region
      left: $peer-point-results-width + 1

    .m-aggregated-conpoints-region
      left: -$peer-point-results-width - 1

    .m-point-peer.m-point-unexpanded .m-point-wrap
      width: $peer-point-wrap-results-width


  // pointlist browsing
  &.m-reasons-browsing .m-reasons-lists
    width: $full_reasons_width + $expanded_points_increment

  &.m-reasons-browsing-cons .m-reasons-lists
    left: $full_reasons_left - $expanded_points_increment 


  &[data-state="separated"]
    .m-aggregated-propoints-region, .m-aggregated-conpoints-region
      &.m-pointlist-browsing
        width: $peer-point-width + $expanded_points_increment

        .m-point-peer.m-point-unexpanded .m-point-wrap
          width: $peer-point-wrap-width + $expanded_points_increment


  &[data-state="together"]
    .m-aggregated-propoints-region, .m-aggregated-conpoints-region
      &.m-pointlist-browsing
        width: $peer-point-results-width + $expanded_points_increment

        .m-point-peer.m-point-unexpanded
          .m-point-wrap
            width: $peer-point-wrap-results-width + $expanded_points_increment


////////// end layout //////////


// Activity-based styles
[data-activity="proposal-no-activity"]
  .m-reasons[data-state="collapsed"]
    display: none

  

[data-visibility="unpublished"]
  .m-reasons
    display: none

[data-activity="proposal-has-activity"]
  .m-reasons[data-state="collapsed"]
    .m-reasons-lists
      min-height: 85px
      //margin-bottom: 100px // spacing for participants block

  .m-reasons
    &[data-state="together"], &[data-state="separated"]
      min-height: 500px

////////////////////




.m-reasons
  margin: $vertical_baseline 0


  &[data-state="collapsed"] .m-aggregated-conpoints-region   
    svg.t-bubble
      left: auto
      right: -23px
      
  &[data-state="separated"], &[data-state="together"], &[data-state="collapsed"] .m-aggregated-propoints-region
    .m-peer-reasons
      > svg.t-bubble
        display: none



  /////////
  // wrapper for a points column, managed by a PointsController
  .m-points-list-region
    position: relative
    vertical-align: top

  .m-position-region
    position: relative
    width: $decision_board_width



  .m-aggregated-propoints-region, .m-aggregated-conpoints-region
    //position: absolute
    top: 0
    z-index: 10

  ////////


  /// The participants block
  &[data-state="separated"]
    > .l-message-speaker
      display: none
    .l-group-container
      

// sticky footer for results (not presented in .m-reasons el)
.m-reasons-footer-sticky
  text-align: center

  a
    width: 100%
    border-radius: 0
    +font-size(2)